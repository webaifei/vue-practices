(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{171:function(t,n,s){"use strict";s.r(n);var a=s(0),e=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"埋点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#埋点","aria-hidden":"true"}},[t._v("#")]),t._v(" 埋点")]),t._v(" "),s("blockquote",[s("p",[t._v("埋点是数据采集的手段， 从开发者角度来讲分为前端埋点和后端埋点；各有优劣。前端埋点的实现方式划分的话，目前存在：手动埋点，自动埋点。其中手动埋点又包含：命令式埋点和声明式埋点和可视化埋点。")])]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("TODO: 各个埋点技术实现原理和对比")])]),t._v(" "),s("p",[t._v("目前我们使用的埋点方式是命令式埋点，它的特点：")]),t._v(" "),s("ol",[s("li",[t._v("灵活，可以实现各种业务埋点需求")]),t._v(" "),s("li",[t._v("需要前端研发同学coding 完成埋点，增加开发量")])]),t._v(" "),s("h2",{attrs:{id:"之前的埋点方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#之前的埋点方案","aria-hidden":"true"}},[t._v("#")]),t._v(" 之前的埋点方案")]),t._v(" "),s("p",[t._v("之前的埋点方案同样使用的是命令式埋点方案，只不过将埋点配置放到了单独的配置文件中，方便集中化的管理。")]),t._v(" "),s("p",[t._v("但是因为几个原因导致实际效果不太理想：")]),t._v(" "),s("ul",[s("li",[t._v("同样需要在编码卖点的代码中去设置特定的个性化参数")]),t._v(" "),s("li",[t._v("对于不同页面中的相同组件，需要在配置中不同的页面下添加相同的埋点配置")]),t._v(" "),s("li",[t._v("实际迭代过程中 修改已有埋点的频率并不是非常高，集中式维护埋点配置的优势得不到提现，及时需要修改埋点配置，因为上面的原因 导致我们还是需要到具体的发送埋点的逻辑代码中进行修改。")])]),t._v(" "),s("h2",{attrs:{id:"重构之后的埋点方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重构之后的埋点方式","aria-hidden":"true"}},[t._v("#")]),t._v(" 重构之后的埋点方式")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("ol",[s("li",[t._v("不再需要在配置文件中维护埋点配置，")]),t._v(" "),s("li",[t._v("兼容配置埋点方式， 对于老的页面 新增埋点同样不需要在配置文件中添加维护")])])]),t._v(" "),s("p",[t._v("回头重新梳理埋点的逻辑，其实针对每一个埋点能够唯一标记并且有固定的规律即可。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("Log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" current_event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// options中核心的两个字段")]),t._v("\noptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("events "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    current_event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" current_event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    current_page"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" currentPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    event_value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" eventValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" eventMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    event_remark"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" eventRemark\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\noptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("retention"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rsd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("assign")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("retention"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rsd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    rsd\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("我们核心关注的就是上面的三个参数： 标记是哪个页面"),s("code",[t._v("currentPage")]),t._v(" 什么事件"),s("code",[t._v("current_event")]),t._v(" 其他说明字段"),s("code",[t._v("options")])]),t._v(" "),s("ol",[s("li",[s("code",[t._v("currentPage")]),t._v(" 通过代码获取当前"),s("code",[t._v("url")]),t._v("的"),s("code",[t._v("pathname")]),t._v(" 自动转换成指定的格式（已下划线_链接的字符串）")]),t._v(" "),s("li",[s("code",[t._v("current_event")]),t._v(" 在调用埋点的时候作为参数传入")]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v("中的字段也同样通过代码进行获取配置")])]),t._v(" "),s("p",[t._v("具体实现查看"),s("code",[t._v("utils/log.js")])]),t._v(" "),s("h2",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),s("h3",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),s("p",[t._v("目前不提供单独的npm包，直接拷贝log.js到你的项目中。")])])}],!1,null,null,null);e.options.__file="log.md";n.default=e.exports}}]);