(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{186:function(t,e,s){"use strict";s.r(e);var n=s(1),a=Object(n.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("hr"),t._v(" "),t._m(1),t._v(" "),s("p",[t._v("预渲染就是将无法同步直出的页面（一般都是通过前端异步加载数据拼接DOM 的SPA路由），通过一些技术手段，获取访问对应路由生成好的html内容生成真实的文件，从而在实际上线之后，首次访问对应的路由就能够直接响应内容，而不是通过javascript动态的生成。")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),s("h3",{attrs:{id:"第一步：-prerender-spa-plugin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第一步：-prerender-spa-plugin","aria-hidden":"true"}},[t._v("#")]),t._v(" 第一步： "),s("a",{attrs:{href:"https://github.com/chrisvfritz/prerender-spa-plugin#readme",target:"_blank",rel:"noopener noreferrer"}},[t._v("prerender-spa-plugin"),s("OutboundLink")],1)]),t._v(" "),t._m(5),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[s("code",[t._v("prerender-spa-plugin")]),t._v("依赖"),s("a",{attrs:{href:"https://github.com/GoogleChrome/puppeteer",target:"_blank",rel:"noopener noreferrer"}},[t._v("puppeteer"),s("OutboundLink")],1),t._v(",")]),t._v(" "),t._m(6)]),t._v(" "),t._m(7),s("ol",{attrs:{start:"2"}},[s("li",[t._v("构建命令修改\n"),s("ul",[s("li",[t._v("如果可以翻墙：手动下载"),s("a",{attrs:{href:"https://download-chromium.appspot.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("chromium"),s("OutboundLink")],1),t._v(" (需要翻墙)将下载的chromium 放到应用程序文件夹或者其他任意的文件夹下")]),t._v(" "),s("li",[t._v("如无法翻墙 也可以使用google chrome 浏览器")]),t._v(" "),t._m(8)]),t._v(" "),t._m(9),t._m(10)]),t._v(" "),s("li",[t._v("修改webpack配置")])]),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),t._m(14),t._v(" "),s("h3",{attrs:{id:"第二步：配合vue-meta-info"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二步：配合vue-meta-info","aria-hidden":"true"}},[t._v("#")]),t._v(" 第二步：配合"),s("a",{attrs:{href:"https://www.npmjs.com/package/vue-meta-info#Usage",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-meta-info"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("在你预渲染的route根组件中添加SEO相关的设置")]),t._v(" "),t._m(15),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._m(19),t._v(" "),t._m(20),s("p",[t._v("或者参考"),s("a",{attrs:{href:"https://gist.github.com/thoop/8165802",target:"_blank",rel:"noopener noreferrer"}},[t._v("这个"),s("OutboundLink")],1)]),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),s("p",[t._v("具体请参考："),s("a",{attrs:{href:"https://ssr.vuejs.org/zh/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%B8%B2%E6%9F%93-ssr-%EF%BC%9F",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue ssr"),s("OutboundLink")],1)])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"预渲染"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#预渲染","aria-hidden":"true"}},[this._v("#")]),this._v(" 预渲染")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"什么是预渲染"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是预渲染","aria-hidden":"true"}},[this._v("#")]),this._v(" 什么是预渲染")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"为啥要预渲染"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为啥要预渲染","aria-hidden":"true"}},[this._v("#")]),this._v(" 为啥要预渲染")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("SEO")]),this._v(" "),e("li",[this._v("首屏响应速度")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"如何实现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何实现","aria-hidden":"true"}},[this._v("#")]),this._v(" 如何实现")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[e("code",[this._v("prerender-spa-plugin")]),this._v("安装")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("而"),e("code",[this._v("puppeteer")]),this._v("依赖Chromium，Chromium文件较大 还需要翻墙。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// 跳过下载chromium\nset PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=1 && npm install prerender-spa-plugin\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[this._v("修改构建命令 ("),e("code",[this._v("PUPPETEER_EXECUTABLE_PATH")]),this._v(" 就是你放置"),e("code",[this._v("chromium")]),this._v("或者"),e("code",[this._v("google chrome")]),this._v("的文件夹)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('//package.json\n{\n  "build": "PUPPETEER_EXECUTABLE_PATH=/Applications/Chromium.app/Contents/MacOS/Chromium vue-cli-service build"\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),e("p",[e("code",[this._v("PUPPETEER_EXECUTABLE_PATH")]),this._v(" 一定是可执行文件的全部路径 而不是存放执行文件的那个文件夹")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PrerenderSPAPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Required - The path to the webpack-outputted app to prerender.")]),t._v("\n      staticDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("build"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("assetsRoot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Required - Routes to render.")]),t._v("\n      routes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/manual"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/customer-service"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/lead"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      renderer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Renderer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          inject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          headless"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          renderAfterDocumentEvent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"render-event"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",{attrs:{start:"5"}},[e("li",[this._v("修改main.js")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-vue extra-class"},[e("pre",{pre:!0,attrs:{class:"language-vue"}},[e("code",[this._v('const app = new Vue({\n    router,\n    store,\n    mounted () {\n    // You\'ll need this for renderAfterDocumentEvent.\n        document.dispatchEvent(new Event("render-event"));\n    },\n    render: h=> h(App)\n});\ndocument.addEventListener("DOMContentLoaded", function () {\n    app.$mount("#app");\n});\n\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("详细的设置，请参考"),e("code",[this._v("prerender-spa-plugin")]),this._v("的文档。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("<template>\n  ...\n</template>\n \n<script>\n  export default {\n    metaInfo: {\n      title: 'My Example App', // set a title\n      meta: [{                 // set meta\n        name: 'keyWords',\n        content: 'My Example App'\n      }]\n      link: [{                 // set link\n        rel: 'asstes',\n        href: 'https://assets-cdn.github.com/'\n      }]\n    }\n  }\n<\/script> \n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("详细配置参考"),e("code",[this._v("vue-meta-info")]),this._v("文档。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"执行构建-发布"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#执行构建-发布","aria-hidden":"true"}},[this._v("#")]),this._v(" 执行构建 发布")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("npm run build\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"第三步：nginx配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#第三步：nginx配置","aria-hidden":"true"}},[this._v("#")]),this._v(" 第三步：nginx配置")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("server {\n       listen       8000;\n       # server_name  somename  alias  another.alias;\n\n       location ^~ /h5-xiaoniu {\n           root   /Users/u51/projects/company/web-h5-distribution/dist/static;\n           try_files $uri $uri/ /index.html;\n       }\n    }\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"使用场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用场景","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用场景")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("非动态页面： 比如 关于我们、新手引导、客服等等。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"注意事项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#注意事项","aria-hidden":"true"}},[this._v("#")]),this._v(" 注意事项")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("如果你的生成的线上包引用的静态资源需要引用线上资源地址，而在进行预渲染的时候没有发布\n解决方案： 使用charles等代理工具代理到本地")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"和ssr服务器渲染的对比"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#和ssr服务器渲染的对比","aria-hidden":"true"}},[this._v("#")]),this._v(" 和SSR服务器渲染的对比")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("解决的问题基本上相同：SEO 和首屏问题")]),this._v(" "),e("li",[this._v("预渲染是在构建的时候生成静态文件，服务器渲染是在接收到请求之后服务器端动态生成响应")]),this._v(" "),e("li",[this._v("SSR 更加强大，相比预渲染成本更高（包括人力和机器成本）")])])}],!1,null,null,null);a.options.__file="prerender.md";e.default=a.exports}}]);